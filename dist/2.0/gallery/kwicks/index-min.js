KISSY.add("brix/gallery/kwicks/index",function(e,t){function i(){i.superclass.constructor.apply(this,arguments)}return i.ATTRS={isVertical:{value:!1},sticky:{value:!1},activeIndex:{value:0},trigger:{value:"li"},triggerType:{value:"mouseenter"},activeCls:{value:"active"},spacing:{value:0},duration:{value:.3},easing:{value:"easeNone"},max:{value:!1},min:{value:!1},autoplay:{value:!1},interval:{value:3e3}},i.EVENTS={"":{mouseenter:function(){var e=this,t=e.get("autoplay");t&&e.stop()},mouseleave:function(){var e=this,t=e.get("autoplay"),i=e.get("sticky");if(t)e.start();else if(!i){var a=e.kwicks,n=a.length,r=e.get("activeCls"),o=e.get("spacing"),s=e.get("duration"),l=e.get("easing"),c=e.LoT,d=e.WoH,u=e.normWoH;a.stop().removeClass(r),a.each(function(e,t){var i={};i[d]=u,n>t&&(i[c]=t*u+t*o),e.animate(i,s,l)})}}}},i.FIRES={beforeSwitchTo:"beforeSwitch","switch":"switch"},i.METHODS={switchTo:function(t){if(this.fire(i.FIRES.beforeSwitch,{toIndex:t})!==!1){var a=this,n=a.kwicks,r=n.length,o=a.preCalcLoTs,s=a.get("activeCls"),l=a.get("duration"),c=a.get("easing"),d=a.LoT,u=a.WoH,p=a.max,h=a.min;t>=r||0>t?(t=0,a.set("activeIndex",0)):a.set("activeIndex",t);var f=n.item(t);n.stop().removeClass(s),f.addClass(s);var g=0;n.each(function(n,s){var v={};v[u]=f[0]==n[0]?p:h,v[d]=o[t][s],n.animate(v,l,c,function(){g++,g==r&&(e.log("fire switch"),a.fire(i.FIRES["switch"],{currentIndex:t}))})})}},start:function(){var t=this,i=t.get("autoplay"),a=t.get("interval");i&&(t.stop(),t.timer=e.later(function(){var e=t.get("activeIndex");t.switchTo(e+1)},a,!0,t))},stop:function(){var e=this;e.timer&&(e.timer.cancel(),e.timer=null)}},e.extend(i,t,{initialize:function(){var e=this,t=e.get("isVertical"),i=e.get("sticky"),a=e.get("activeIndex"),n=e.get("triggerType"),r=e.get("activeCls"),o=e.get("spacing"),s=(e.get("duration"),e.get("easing"),e.max=e.get("max")),l=e.min=e.get("min");e.get("autoplay");var c=e.WoH=t?"height":"width",d=e.LoT=t?"top":"left",u=e.get("el"),p=e.kwicks=u.all(e.get("trigger")),h=p.length,f=e.normWoH=p.item(0).css(c).replace(/px/,"");s?l=e.min=(f*h-s)/(h-1):s=e.max=f*h-l*(h-1),t?u.css({width:p.item(0).css("width"),height:f*h+o*(h-1)+"px"}):u.css({width:f*h+o*(h-1)+"px",height:p.item(0).css("height")});for(var g=e.preCalcLoTs=[],v=0;h>v;v++){g[v]=[];for(var m=0;h>m;m++)g[v][m]=v==m?t?m*l+m*o:m*l+m*o:(v>m?m*l:(m-1)*l+s)+m*o}p.each(function(t,u){i?t.css(d,g[a][u]):t.css(d,u*f+u*o),i&&(a==u?(t.css(c,s+"px"),t.addClass(r)):t.css(c,l+"px")),t.css({margin:0,position:"absolute"}),t.on(n,function(){e.switchTo(u)})}),e.start()},destructor:function(){self.timer&&(self.timer.cancel(),self.timer=null,self.kwicks=null)}}),e.augment(i,i.METHODS),i},{requires:["brix/core/brick"]});