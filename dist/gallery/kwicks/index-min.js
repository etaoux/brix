KISSY.add("brix/gallery/kwicks/index",function(a,b){function c(){c.superclass.constructor.apply(this,arguments)}return c.ATTRS={isVertical:{value:!1},sticky:{value:!1},activeIndex:{value:0},triggerType:{value:"mouseenter"},activeCls:{value:"active"},spacing:{value:0},duration:{value:.3},easing:{value:"easeNone"},max:{},min:{},autoplay:{value:!1},interval:{value:3e3}},c.ATTACH={"":{mouseenter:function(){var a=this,b=a.get("autoplay");b&&a.stop()},mouseleave:function(){var a=this,b=a.get("autoplay"),c=a.get("sticky");if(b)a.start();else if(!c){var d=a.kwicks,e=d.length,f=a.get("activeCls"),g=a.get("spacing"),h=a.get("duration"),i=a.get("easing"),j=a.LoT,k=a.WoH,l=a.normWoH;d.stop().removeClass(f),d.each(function(a,b){var c={};c[k]=l,b<e-1&&(c[j]=b*l+b*g),a.animate(c,h,i)})}}}},c.METHOD={switchTo:function(a){var b=this,c=b.kwicks,d=c.length,e=b.preCalcLoTs,f=b.get("activeCls"),g=b.get("duration"),h=b.get("easing"),i=b.LoT,j=b.WoH,k=b.max,l=b.min;a>=d||a<0?(a=0,b.set("activeIndex",0)):b.set("activeIndex",a);var m=c.item(a);c.stop().removeClass(f),m.addClass(f),c.each(function(b,c){var f={};m[0]==b[0]?(f[j]=k,c>0&&c<d-1&&(f[i]=e[a][c])):(f[j]=l,c>0&&c<d-1&&(f[i]=e[a][c])),b.animate(f,g,h)})},start:function(){var b=this,c=b.get("autoplay"),d=b.get("interval");c&&(b.stop(),b.timer=a.later(function(){var a=b.get("activeIndex");b.switchTo(a+1)},d,!0,b))},stop:function(){var a=this;a.timer&&(a.timer.cancel(),a.timer=null)}},a.extend(c,b,{initialize:function(){var a=this,b=a.get("isVertical"),c=a.get("sticky"),d=a.get("activeIndex"),e=a.get("triggerType"),f=a.get("activeCls"),g=a.get("spacing"),h=a.get("duration"),k=a.get("easing"),l=a.max=a.get("max"),m=a.min=a.get("min"),n=a.get("autoplay"),o=a.WoH=b?"height":"width",p=a.LoT=b?"top":"left",q=a.get("el"),r=a.kwicks=q.all("li"),s=r.length,t=a.normWoH=r.item(0).css(o).replace(/px/,"");l?m=a.min=(t*s-l)/(s-1):l=a.max=t*s-m*(s-1),b?q.css({width:r.item(0).css("width"),height:t*s+g*(s-1)+"px"}):q.css({width:t*s+g*(s-1)+"px",height:r.item(0).css("height")});var u=a.preCalcLoTs=[];for(i=0;i<s;i++){u[i]=[];for(j=1;j<s-1;j++)i==j?u[i][j]=b?j*m+j*g:j*m+j*g:u[i][j]=(j<=i?j*m:(j-1)*m+l)+j*g}r.each(function(h,i){i===0?h.css(p,"0px"):i==s-1?h.css(b?"bottom":"right","0px"):c?h.css(p,u[d][i]):h.css(p,i*t+i*g),c&&(d==i?(h.css(o,l+"px"),h.addClass(f)):h.css(o,m+"px")),h.css({margin:0,position:"absolute"}),h.on(e,function(){a.switchTo(i)})}),a.start()},destructor:function(){self.timer&&(self.timer.cancel(),self.timer=null,self.kwicks=null)}}),a.augment(c,c.METHOD),c},{requires:["brix/core/brick"]});