KISSY.add("brix/gallery/tips/index",function(a,b,c,d){function i(){i.superclass.constructor.apply(this,arguments)}var e=c.all,f=a.DOM,g=a.Event,h=0;return i.ATTRS={dataAttrName:{value:"data-tips"},closeable:{value:!0},length:{},"tmpl-tip":{value:'<div id="{{id}}" class="bx-tips-show {{hide}}" style="display: none;position: absolute;top:0;left:0"><p class="bx-tips-msg">{{tips}}</p><i class="bx-tips-tri bx-tips-top"></i><span class="bx-tips-close">\u5173\u95ed</span></div>'},tips:{value:{}},timers:{value:{}},prex:{value:"bx-tip-"},trisize:{value:{width:16,height:9,paddingw:14,paddingh:12}},el:{value:"body"},order:{value:["RB","BR","LB","LT","TL","TR","RT","BL"]},timeout:{value:3}},i.DOCATTACH={".bx-tips":{mouseenter:function(a){var b=a.currentTarget;this.showTips(b)},mouseleave:function(a){var b=a.currentTarget;this.hideTips(b)}},".bx-tips-close":{click:function(a){var b=a.currentTarget,c=this,d=f.parent(b,".bx-tips-show");c.closeTips(d)}}},i.METHOD={showTips:function(a){var b=this,c=b._getTipId(a);if(!c||!b.get("tips")[c]){c=b._createTipId();var g=d(b.get("tmpl-tip")).render({id:c,tips:f.attr(a,b.get("dataAttrName")),hide:b.get("closeable")?"":"bx-tips-uncloseable"});b.get("tips")[c]=c,f.attr(a,"data-tipid",c),e(g).appendTo("body")}b._posTip(a,f.get("#"+c))},hideTips:function(a){var b=this,c=b._getTipId(a),d=f.get("#"+c),e=setTimeout(function(){f.hide(d),f.css(d,{left:"-9999px",top:"-9999px"})},b.get("timeout")*1e3);b.get("timers")[c]=e},closeTips:function(a){this._clearTimer(a.id),f.hide(a),f.css(a,{left:"-9999px",top:"-9999px"})},_clearTimer:function(a){var b=this.get("timers")[a];b&&(clearTimeout(b),delete this.get("timers")[a])},_createTipId:function(){return this.get("prex")+ ++h},_posTip:function(a,b){var c=this,d=f.offset(a),e=d.left,g=d.top,h={x1:e,y1:g,x2:e+f.innerWidth(a),y2:g+f.innerHeight(a)},i=f.viewportWidth(),j=f.viewportHeight(),k=f.scrollLeft(window),l=f.scrollTop(window),m={x1:k,y1:l,x2:k+i,y2:l+j};c._clearTimer(c._getTipId(a)),f.show(b);var n={tip:b,w:f.outerWidth(b),h:f.outerHeight(b)},o,p=c.get("order"),q=p.length;for(var r=0;r<q;r++){o=c["_test"+p[r]](h,n,m);if(o)break}var s=f.get(".bx-tips-tri",b);f.attr(b,"class",c.get("closeable")?"bx-tips-show":"bx-tips-show bx-tips-uncloseable"),f.addClass(b,o.cls),f.css(b,{position:"absolute",left:o.left+"px",top:o.top+"px"})},_testBR:function(a,b,c){var d=this.get("trisize"),e=d.width+d.paddingw*2,f=d.height,g=a.x2-e,h=a.y2+f,i=g+b.w,j=h+b.h;return i>c.x2||j>c.y2||h<c.y1?!1:{left:g,top:h,cls:"bx-tips-br"}},_testTL:function(a,b,c){var d=this.get("trisize"),e=d.width+d.paddingw*2,f=d.height,g=a.x1-b.w+e,h=a.y1-b.h-f,i=h+b.h;return g<c.x1||h<c.y1||i>c.y2?!1:{left:g,top:h,cls:"bx-tips-tl"}},_testBL:function(a,b,c){var d=this.get("trisize"),e=d.width+d.paddingw*2,f=d.height,g=a.x1-b.w+e,h=a.y2+f,i=h+b.h;return g<c.x1||i>c.y2||h<c.y1?!1:{left:g,top:h,cls:"bx-tips-bl"}},_testTR:function(a,b,c){var d=this.get("trisize"),e=d.width+d.paddingw*2,f=d.height,g=a.x2-e,h=a.y1-b.h-f,i=g+b.w,j=h+b.h;return i>c.x2||h<c.y1||j>c.y2?!1:{left:g,top:h,cls:"bx-tips-tr"}},_testLT:function(a,b,c){var d=this.get("trisize"),e=d.height,f=d.width+d.paddingh*2,g=a.x1-b.w-e,h=a.y1-b.h+f,i=h+b.h;return g<c.x1||h<c.y1||i>c.y2?!1:{left:g,top:h,cls:"bx-tips-lt"}},_testLB:function(a,b,c){var d=this.get("trisize"),e=d.height,f=d.width+d.paddingh*2,g=a.x1-b.w-e,h=a.y2-f,i=h+b.h;return g<c.x1||i>c.y2||h<c.y1?!1:{left:g,top:h,cls:"bx-tips-lb"}},_testRT:function(a,b,c){var d=this.get("trisize"),e=d.height,f=d.width+d.paddingh*2,g=a.x2+e,h=a.y1-b.h+f,i=g+b.w,j=h+b.h;return i>c.x2||h<c.y1||j>c.y2?!1:{left:g,top:h,cls:"bx-tips-rt"}},_testRB:function(a,b,c){var d=this.get("trisize"),e=d.height,f=d.width+d.paddingh*2,g=a.x2+e,h=a.y2-f,i=g+b.w,j=h+b.h;return i>c.x2||j>c.y2||h<c.y1?!1:{left:g,top:h,cls:"bx-tips-rb"}},_getTipId:function(a){return f.attr(a,"data-tipid")}},a.extend(i,b,{initialize:function(){var b=this;window.onresize=function(){var c=b.get("tips");a.each(c,function(a){b.closeTips(f.get("#"+a))})},a.UA.ie&&a.UA.ie==6&&g.delegate("html","mouseenter mouseleave",".bx-tips-close",function(a){a.type==="mouseenter"?f.addClass(a.currentTarget,"hover"):f.removeClass(a.currentTarget,"hover")})},destructor:function(){}}),a.augment(i,i.METHOD),i},{requires:["brix/core/brick","node","template"]});